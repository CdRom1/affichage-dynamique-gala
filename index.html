<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">


<style>

body {
  color:white;
  background-color: black;
  background-image: url("fondGalaHorizontal.jpeg");
  background-size: 90vw 100vh;
  background-position: top;
  background-repeat: no-repeat;
}

ul {
  list-style-type: none;
  padding: 0;
}

.content {
  font-family: Helvetica;
  font-size: 1em;
  padding-left: 8%;
  padding-right: 8%;
  margin-top: calc(15%);
}

.main_table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 5px
}

.sub_table {
  width: 100%;
}

.titres_scenes {
  font-weight: bolder;
  text-align: center;
  margin-top: 1em;
  margin-bottom: 1em;
  font-size: 1.2em;
}

td {
  margin-top: 0;
  margin-bottom: 0;
  text-align: left;
}

#logo{
  height: 100%;
  display: block;
  display: block;
  margin-left: auto;
  margin-right: auto;
}

#logo_container {
  position: absolute;
  top: calc(3%);
  left: 0px;
  width: 100%;
  height: 13%;
}



.titres_prochainement, .titres_en_cours {
  text-align: center;
  font-size: 1.2em;
    padding-top: 50px;
}

.titres_prochainement, .titres_en_cours, .temps_restant {
  font-style: italic;
}


.anim_temps_restant, .temps_restant {
  font-size: 1.2em;
}

.nom_evenement_en_cours, .nom_prochain_evenement, .anim_en_cours_nom{
  font-size: 2em;
  text-align: center;
}

.col_fsc, .col_larsen, .col_pro {
  border-right: 1px solid white;
}

.col_fsc, .col_larsen, .col_pro, .col_anim {
  width: 25%;
}

</style>




</head>

  <body>
    <div class="content">
      <div id="logo_container">
        <img src="titre_gala_utc.png" id="logo"></img>
      </div>
<table class="main_table">
  <tr class="titres_scenes">
    <th class="col_fsc">Scène FSC</th>
    <th class="col_larsen">Scène Larsen</th>
    <th class="col_pro">Main Stage</th>
    <th class="col_anim">Animations</th>
  </tr>





  <tr>
    <td class="titres_en_cours col_fsc" id="fsc_ev_en_cours_etat">En cours</td>
    <td class="titres_en_cours col_larsen" id="larsen_ev_en_cours_etat">En cours</td>
    <td class="titres_en_cours col_pro" id="pro_ev_en_cours_etat">En cours</td>
    <td class="titres_en_cours col_anim" id="anim_ev_en_cours_etat">En cours</td>
  </tr>

  <tr>
    <td class="nom_evenement_en_cours col_fsc" id="fsc_ev_en_cours_nom">Nom év en cours sc1</td>
    <td class="nom_evenement_en_cours col_larsen" id="larsen_ev_en_cours_nom">Nom év en cours sc2</td>
    <td class="nom_evenement_en_cours col_pro" id="pro_ev_en_cours_nom">Nom év en cours sc3</td>
    <td id="anim_ev_en_cours_nom" class="col_anim">Noms év en cours anim</td>
  </tr>

  <tr class="ligne_titres_prochainement">
    <td class="titres_prochainement col_fsc" id="fsc_prochain_etat">Prochainement</td>
    <td class="titres_prochainement col_larsen" id="larsen_prochain_etat">Prochainement</td>
    <td class="titres_prochainement col_pro" id="pro_prochain_etat">Prochainement</td>
    <td class="titres_prochainement col_anim" id="anim_prochain_etat">Prochainement</td>
  </tr>

  <tr>
    <td class="col_fsc"><table class="sub_table"><tr><td class="nom_prochain_evenement" id="fsc_ev_prochain_nom">Nom du prochain év sc1</td><td class="temps_restant" id="fsc_ev_prochain_temps_restant">Dans X minutes</td></td></tr></table></td>
    <td class="col_larsen"><table class="sub_table"><tr><td class="nom_prochain_evenement" id="larsen_ev_prochain_nom">Nom du prochain év sc2</td><td class="temps_restant" id="larsen_ev_prochain_temps_restant">Dans X minutes</td></tr></table></td>
    <td class="col_pro"><table class="sub_table"><tr><td class="nom_prochain_evenement" id="pro_ev_prochain_nom">Nom du prochain év sc3</td><td class="temps_restant" id="pro_ev_prochain_temps_restant">Dans X minutes</td></tr></table></td>
    <td class="col_anim"><table class="sub_table"><tr><td rowspan="2" id="anim_ev_prochain">Prochaines animations</td><!-- Cette cellule a été fusionnée avec anim_ev_prochain --></tr></table></td>
  </tr>

</table>
</div>



<script>

var fsc = [
{ nom: "Zen'Hit",
  debut: new Date(2018, 11, 15, 22, 45),
  fin: new Date(2018, 11, 15, 23, 35),
},
{ nom: "TED",
  debut: new Date(2018, 11, 15, 23, 35),
  fin: new Date(2018, 11, 16, 0, 25),
},
{ nom: "Touzö",
  debut: new Date(2018, 11, 16, 0, 25),
  fin: new Date(2018, 11, 16, 1, 15),
},
{ nom: "Madjer",
  debut: new Date(2018, 11, 16, 1, 15),
  fin: new Date(2018, 11, 16, 2, 5),
},
{ nom: "Kiki et Cado",
  debut: new Date(2018, 11, 16, 2, 5),
  fin: new Date(2018, 11, 16, 2, 55),
},
{ nom: "Cactus & Racket",
  debut: new Date(2018, 11, 16, 2, 55),
  fin: new Date(2018, 11, 16, 3, 30),
},
]
var larsen = [
{ nom: "R404",
  debut: new Date(2018, 11, 15, 22, 45),
  fin: new Date(2018, 11, 15, 23, 15),
},
{ nom: "Originals",
  debut: new Date(2018, 11, 16, 0, 0),
  fin: new Date(2018, 11, 16, 1, 0),
},
{ nom: "Chicken Swing",
  debut: new Date(2018, 11, 16, 1, 0),
  fin: new Date(2018, 11, 16, 2, 0),
},
{ nom: "Oktopod",
  debut: new Date(2018, 11, 16, 2, 0),
  fin: new Date(2018, 11, 16, 3, 30),
},
]
var pro = [
{ nom: "Nawui",
  debut: new Date(2018, 11, 15, 22, 30),
  fin: new Date(2018, 11, 15, 23, 20),
},
{ nom: "Blow",
  debut: new Date(2018, 11, 16, 0, 0),
  fin: new Date(2018, 11, 16, 1, 30),
},
{ nom: "Faul&Wad",
  debut: new Date(2018, 11, 16, 1, 45),
  fin: new Date(2018, 11, 16, 2, 35),
},
{ nom: "DSCNT",
  debut: new Date(2018, 11, 16, 2, 35),
  fin: new Date(2018, 11, 16, 3, 25),
},
{ nom: "TULUM",
  debut: new Date(2018, 11, 16, 3, 25),
  fin: new Date(2018, 11, 16, 4, 15),
},
]
var anim = [
{ nom: "Concert Stravaganza BROADWAY",
  debut: new Date(2018, 11, 15, 21, 0),
  fin: new Date(2018, 11, 12, 22, 0),
},
{ nom: "Défilé de mode",
  debut: new Date(2018, 11, 15, 22, 0),
  fin: new Date(2018, 11, 12, 22, 15),
},
{ nom: "Acrockeur",
  debut: new Date(2018, 11, 15, 22, 30),
  fin: new Date(2018, 11, 15, 22, 45),
},
{ nom: "PIC'N'Rock",
  debut: new Date(2018, 11, 15, 22, 45),
  fin: new Date(2018, 11, 15, 23, 0),
},
{ nom: "Salsa",
  debut: new Date(2018, 11, 15, 23, 0),
  fin: new Date(2018, 11, 15, 23, 20),
},
{ nom: "Hypn'UT'ic",
  debut: new Date(2018, 11, 15, 20, 0),
  fin: new Date(2018, 11, 15, 23, 15),
},
{ nom: "Profit'rôles",
  debut: new Date(2018, 11, 15, 23, 15),
  fin: new Date(2018, 11, 15, 23, 45),
},
{ nom: "Poker",
  debut: new Date(2018, 11, 15, 20, 30),
  fin: new Date(2018, 11, 16, 1, 0),
},
{ nom: "Feu d'artifice",
  debut: new Date(2018, 11, 15, 23, 30),
  fin: new Date(2018, 11, 15, 23, 45),
},
{ nom: "Blind Test",
  debut: new Date(2018, 11, 15, 20, 0),
  fin: new Date(2018, 11, 15, 23, 0),
},
{ nom: "Piano libre service",
  debut: new Date(2018, 11, 15, 23, 45),
  fin: new Date(2018, 11, 15, 3, 0),
},
]

var deuxChiffres = new Intl.NumberFormat("fr", {minimumIntegerDigits:2});

alerte();

function alerte() {
var d = new Date();
var d15minutes = new Date(d.getTime() + (15 * 60 * 1000));


var fscEnCours, fscProchain;
var larsenEnCours, larsenProchain;
var proEnCours, proProchain;
var animsEnCours = [];
var animsProchaines = [];



//parsage FSC
fsc.forEach( (ev) => {
  if(d > ev.debut && ev.fin > d ) {fscEnCours = ev;}
  if(d < ev.debut && ev.debut < d15minutes) {fscProchain = ev;}
})

larsen.forEach( (ev) => {
  if(d > ev.debut && ev.fin > d ) {larsenEnCours = ev;}
  if(d < ev.debut && ev.debut < d15minutes) {larsenProchain = ev;}
})

pro.forEach( (ev) => {
  if(d > ev.debut && ev.fin > d ) {proEnCours = ev;}
  if(d < ev.debut && ev.debut < d15minutes) {proProchain = ev;}
})

//parsage Animations
anim.forEach( (ev) => {
  if(d > ev.debut && ev.fin > d ) { animsEnCours.push(ev); }
  if(d < ev.debut && ev.debut < d15minutes) { animsProchaines.push(ev);}
})

//Affichage FSC
affichageScene(fscEnCours,fscProchain,document.getElementById("fsc_ev_en_cours_nom"),document.getElementById("fsc_ev_en_cours_etat"),document.getElementById("fsc_ev_prochain_nom"),document.getElementById("fsc_ev_prochain_temps_restant"), document.getElementById("fsc_prochain_etat"))
affichageScene(larsenEnCours,larsenProchain,document.getElementById("larsen_ev_en_cours_nom"),document.getElementById("larsen_ev_en_cours_etat"),document.getElementById("larsen_ev_prochain_nom"),document.getElementById("larsen_ev_prochain_temps_restant"), document.getElementById("larsen_prochain_etat"))
affichageScene(proEnCours,proProchain,document.getElementById("pro_ev_en_cours_nom"),document.getElementById("pro_ev_en_cours_etat"),document.getElementById("pro_ev_prochain_nom"),document.getElementById("pro_ev_prochain_temps_restant"), document.getElementById("pro_prochain_etat"))
affichageAnimation(animsEnCours, animsProchaines, document.getElementById("anim_ev_en_cours_nom"),document.getElementById("anim_ev_en_cours_etat"),document.getElementById("anim_ev_prochain"), document.getElementById("anim_prochain_etat"))

  setTimeout(alerte, 1000);
}



//prend en argument les deux objets d'événement, et les tags HTML dans lesquels il faut output le texte
function affichageScene(encours, prochain, encours_nom, encours_etat, prochain_nom, prochain_temps, prochain_etat) {
var d = new Date();
  //TODO: remplacer le 'rien' par rien, c'est pas très classe pour le gala
  encours_nom.innerHTML = encours ? encours.nom : "";
  encours_etat.innerHTML = encours ? "En cours" : "";
  prochain_nom.innerHTML = prochain ? prochain.nom : "";
  let delaySeconds = prochain ? Math.floor((prochain.debut.getTime() - d.getTime())/1000) : 0;
  let minutes = Math.floor(delaySeconds / 60);
  let secondes = Math.floor(delaySeconds % 60);
  prochain_temps.innerHTML = prochain ? deuxChiffres.format(minutes) + " : " + deuxChiffres.format(secondes) : "";
  prochain_etat.innerHTML = prochain ? "Prochainement" : "";
}

//prend en argument deux array contenant des objets d'événement, et les tags HTML dans lesquels il faut output le texte
function affichageAnimation(encours, prochain, encours_nom, encours_etat, prochain_cellule, prochain_etat) {
var d = new Date();
  //TODO: remplacer le 'rien' par rien, c'est pas très classe pour le gala
  if(encours.length == 0) {
  encours_nom.innerHTML = "";
  encours_etat.innerHTML = "";
}
else {
  let output = "<table class='sub_table'>";
  encours.forEach( (ev) => {
    output += '<tr><td class="nom_evenement_en_cours" >' + ev.nom +'</td></tr>';
  });
  output += "</table>";
  encours_nom.innerHTML = output;
  encours_etat.innerHTML = "En cours";
}

if(prochain.length == 0) {
  prochain_cellule.innerHTML = "";
  prochain_etat.innerHTML = "";
}
else {
  let output = "<table class='sub_table'>";
 prochain.forEach( (ev) => {
   let delaySeconds = Math.floor((ev.debut.getTime() - d.getTime())/1000);
   let minutes = Math.floor(delaySeconds / 60);
   let secondes = Math.floor(delaySeconds % 60);
   output += "<tr><td class='nom_prochain_evenement'>"+ev.nom +"</td><td class='anim_temps_restant temps_restant'>" + deuxChiffres.format(minutes) + " : " + deuxChiffres.format(secondes) + "</td></tr>"
 });
 output += "</table>";
prochain_cellule.innerHTML = output;
prochain_etat.innerHTML = "Prochainement"
}

}

</script>
</body>
</html>
